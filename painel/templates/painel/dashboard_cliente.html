{% extends 'painel/base.html' %}
{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold mb-0">Meu Painel</h2>
            <p class="text-muted">Bem-vindo, <strong>{{ request.user.get_full_name|default:request.user.username }}</strong>!</p>
        </div>
        <a href="/agendamentos/agendar/" class="btn btn-primary shadow-sm px-4 rounded-3">Novo Agendamento</a>
    </div>

    <div class="row mb-5">
        <div class="col-md-4">
            <div class="card p-4 shadow-sm border-0 text-white" style="background: linear-gradient(45deg, #0d6efd, #0046af); border-radius: 20px;">
                <h6 class="opacity-75">Agendamentos Marcados</h6>
                <p class="display-4 fw-bold mb-0">{{ total_futuros }}</p>
            </div>
        </div>
    </div>

    <h4 class="fw-bold mb-3">Status dos Meus Pedidos</h4>
    <div class="card shadow-sm border-0" style="border-radius: 15px; overflow: hidden;">
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="table-light">
                    <tr>
                        <th class="ps-4">Profissional</th>
                        <th>Serviço</th>
                        <th>Data e Hora</th>
                        <th class="text-center">Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for a in agendamentos %}
                    <tr>
                        <td class="ps-4">
                            <strong>{{ a.funcionario.user.get_full_name|default:a.funcionario.user.username }}</strong>
                        </td>
                        <td>{{ a.servico.nome }}</td>
                        <td>{{ a.data_horario|date:"d/m/Y H:i" }}</td>
                        <td class="text-center">
                            <span class="badge rounded-pill {% if a.status == 'confirmado' or a.status == 'Agendado' %}bg-success{% elif a.status == 'cancelado' %}bg-danger{% else %}bg-warning text-dark{% endif %}">
                                {{ a.status|title }}
                            </span>
                        </td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="4" class="text-center py-5 text-muted">Você ainda não tem agendamentos.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}